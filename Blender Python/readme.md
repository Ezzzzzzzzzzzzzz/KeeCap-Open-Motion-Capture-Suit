This code works in blender 2.x not the 3.x series, it could be ported, but I haven't done it yet.
